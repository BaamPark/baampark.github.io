---
title: 'Segment Anything, the first large-scale foundation model for segmentation'
date: '2025-01-29T13:49:47-05:00'
draft: false
params:
  math: true
tags: [Segmentation]
---
![SAM](/images/2025-01-29_SAM/intro.png)
[Segment Anything (SAM)](https://openaccess.thecvf.com/content/ICCV2023/html/Kirillov_Segment_Anything_ICCV_2023_paper.html) has drawn massive attention in the computer vision community, accumulating an impressive 8,000 citations. Segmentation has long been a crucial yet challenging aspect of computer vision. One of the biggest hurdles? Annotation. Unlike simple bounding boxes, which only require marking the object’s general location, segmentation demands precise pixel-level annotations—an incredibly tedious and time-consuming task for annotators. SAM is one of the first large-scale foundation models for segmentation. What makes SAM truly great is that it’s a promptable model. This means you can use it for various tasks without the need for fine-tuning—also known as zero-shot learning. Unlike LLM, here the prompts for the SAM are points, bounding boxes, and masks.

What magics happen behind the hood? In this article, we will uncover key technologies of the SAM, the model architecture and training scheme. 

## Interactive Learning
Interactive learning is a machine learning paradigm, similar to active learning, self-supervised learning, and semi-supervised learning. It focuses on models that continuously learn and improve through interaction with users or their environment. I have a good anology to describe interactive learning.

Let's say you are working on a homework assignment where you need to translate English sentences into Korean. On your first attempt, you have zero knowledge of Korean. The professor provides a partial solution, 10% of correct answer. After studying this incomplete solution, you try again. This time, the professor provides 20% of each translation. You continue this process, receiving progressively more of the correct translation with each attempt. Eventually, when the professor provides the full solution, you would be able to ace the assignment. This is how interactive learning works. The model learns from the teacher's feedback on the student's performance, allowing it to adapt and improve over time.

Now, you might have some sense of interactive learning. Here is the funny truth about the analogy. Actually, the professor didn't have the full solutions in the begining because he was too lazy. What's funnier is that the professor used some of the student's homework to progress the solution after each attempt. Eventually, the professor saved his efforts. I said "lazy," but actually, this is a common problem in the machine learning world. We don't have enough manpower to annotate labels for large datasets. Specifically, annotating segmentation is really painful and tedious work. This is why the authors of SAM employed interactive learning because they wanted to build a large-scale dataset. Specifically, this approach is called interactive segmentation. For interactive segmentation, the annotators need to provide points or boundning boxes as partial labels. The authors refer to the interactive environment as a "data engine" and divide it into three stages to streamline the annotation process
> The data engine has three stages: (1) a model-assisted manual annotation stage, (2) a semi-automatic stage with a mix of automatically predicted masks and model-assisted annotation, and (3) a fully automatic stage in which our model generates masks without annotator input. 

In the end, they built SA-1B dataset by annoating 11M imagese with 1B masks.

## Image Encoder

## Prompt Encoder

## Mask decoder

## Reference
- [Segment Anything](https://openaccess.thecvf.com/content/ICCV2023/html/Kirillov_Segment_Anything_ICCV_2023_paper.html)
- [A Comprehensive Survey on Segment Anything Model for Vision and Beyond](https://arxiv.org/pdf/2305.08196)
- [Explaining the Segment Anything Model - Network architecture, Dataset, Training](https://www.youtube.com/watch?v=OhxJkqD1vuE&t=280s)
- [Medical image segmentation using deep learning: A survey](https://ietresearch.onlinelibrary.wiley.com/doi/full/10.1049/ipr2.12419)

